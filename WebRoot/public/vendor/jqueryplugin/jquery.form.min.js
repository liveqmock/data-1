(function(b){function w(a){var g=a.data;a.isDefaultPrevented()||(a.preventDefault(),b(this).ajaxSubmit(g))}function u(a){var g=a.target,c=b(g);if(!c.is("[type=submit],[type=image]")){g=c.closest("[type=submit]");if(0===g.length)return;g=g[0]}var d=this;d.clk=g;"image"==g.type&&(void 0!==a.offsetX?(d.clk_x=a.offsetX,d.clk_y=a.offsetY):"function"==typeof b.fn.offset?(c=c.offset(),d.clk_x=a.pageX-c.left,d.clk_y=a.pageY-c.top):(d.clk_x=a.pageX-g.offsetLeft,d.clk_y=a.pageY-g.offsetTop));setTimeout(function(){d.clk=
d.clk_x=d.clk_y=null},100)}function q(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}var z,B;z=void 0!==b("<input type='file'/>").get(0).files;B=void 0!==window.FormData;var D=!!b.fn.prop;b.fn.attr2=function(){if(!D)return this.attr.apply(this,arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"===typeof a?a:
this.attr.apply(this,arguments)};b.fn.ajaxSubmit=function(a){function g(a){a=b.param(a).split("&");var d=a.length,g=[],f,c;for(f=0;f<d;f++)a[f]=a[f].replace(/\+/g," "),c=a[f].split("="),g.push([decodeURIComponent(c[0]),decodeURIComponent(c[1])]);return g}function c(d){for(var f=new FormData,c=0;c<d.length;c++)f.append(d[c].name,d[c].value);if(a.extraData){d=g(a.extraData);for(c=0;c<d.length;c++)d[c]&&f.append(d[c][0],d[c][1])}a.data=null;c=b.extend(!0,{},b.ajaxSettings,a,{contentType:!1,processData:!1,
cache:!1,type:n||"POST"});a.uploadProgress&&(c.xhr=function(){var b=jQuery.ajaxSettings.xhr();b.upload&&b.upload.addEventListener("progress",function(b){var e=0,c=b.loaded||b.position,d=b.total;b.lengthComputable&&(e=Math.ceil(100*(c/d)));a.uploadProgress(b,c,d,e)},!1);return b});c.data=null;var k=c.beforeSend;c.beforeSend=function(a,b){b.data=f;k&&k.call(this,a,b)};return b.ajax(c)}function d(c){function d(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(c){q("cannot get iframe.contentWindow document: "+
c)}if(b)return b;try{b=a.contentDocument?a.contentDocument:a.document}catch(e){q("cannot get iframe.contentDocument: "+e),b=a.document}return b}function f(){function a(){try{var b=d(v).readyState;q("state = "+b);b&&"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(c){q("Server abort: ",c," (",c.name,")"),g(z),u&&clearTimeout(u),u=void 0}}var c=p.attr2("target"),h=p.attr2("action");k.setAttribute("target",s);n||k.setAttribute("method","POST");h!=e.url&&k.setAttribute("action",e.url);!e.skipEncodingOverride&&
(!n||/post/i.test(n))&&p.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});e.timeout&&(u=setTimeout(function(){w=!0;g(A)},e.timeout));var l=[];try{if(e.extraData)for(var m in e.extraData)e.extraData.hasOwnProperty(m)&&(b.isPlainObject(e.extraData[m])&&e.extraData[m].hasOwnProperty("name")&&e.extraData[m].hasOwnProperty("value")?l.push(b('<input type="hidden" name="'+e.extraData[m].name+'">').val(e.extraData[m].value).appendTo(k)[0]):l.push(b('<input type="hidden" name="'+m+'">').val(e.extraData[m]).appendTo(k)[0]));
e.iframeTarget||(x.appendTo("body"),v.attachEvent?v.attachEvent("onload",g):v.addEventListener("load",g,!1));setTimeout(a,15);try{k.submit()}catch(r){document.createElement("form").submit.apply(k)}}finally{k.setAttribute("action",h),c?k.setAttribute("target",c):p.removeAttr("target"),b(l).remove()}}function g(a){if(!h.aborted&&!F)if(r=d(v),r||(q("cannot access response document"),a=z),a===A&&h)h.abort("timeout"),y.reject(h,"timeout");else if(a==z&&h)h.abort("server abort"),y.reject(h,"error","server abort");
else if(r&&r.location.href!=e.iframeSrc||w){v.detachEvent?v.detachEvent("onload",g):v.removeEventListener("load",g,!1);a="success";var c;try{if(w)throw"timeout";var f="xml"==e.dataType||r.XMLDocument||b.isXMLDoc(r);q("isXml="+f);if(!f&&(window.opera&&(null===r.body||!r.body.innerHTML))&&--C){q("requeing onLoad callback, DOM not available");setTimeout(g,250);return}var k=r.body?r.body:r.documentElement;h.responseText=k?k.innerHTML:null;h.responseXML=r.XMLDocument?r.XMLDocument:r;f&&(e.dataType="xml");
h.getResponseHeader=function(a){return{"content-type":e.dataType}[a]};k&&(h.status=Number(k.getAttribute("status"))||h.status,h.statusText=k.getAttribute("statusText")||h.statusText);var l=(e.dataType||"").toLowerCase(),n=/(json|script|text)/.test(l);if(n||e.textarea){var m=r.getElementsByTagName("textarea")[0];if(m)h.responseText=m.value,h.status=Number(m.getAttribute("status"))||h.status,h.statusText=m.getAttribute("statusText")||h.statusText;else if(n){var p=r.getElementsByTagName("pre")[0],s=
r.getElementsByTagName("body")[0];p?h.responseText=p.textContent?p.textContent:p.innerText:s&&(h.responseText=s.textContent?s.textContent:s.innerText)}}else"xml"==l&&(!h.responseXML&&h.responseText)&&(h.responseXML=H(h.responseText));try{B=I(h,l,e)}catch(G){a="parsererror",h.error=c=G||a}}catch(E){q("error caught: ",E),a="error",h.error=c=E||a}h.aborted&&(q("upload aborted"),a=null);h.status&&(a=200<=h.status&&300>h.status||304===h.status?"success":"error");"success"===a?(e.success&&e.success.call(e.context,
B,"success",h),y.resolve(h.responseText,"success",h),t&&b.event.trigger("ajaxSuccess",[h,e])):a&&(void 0===c&&(c=h.statusText),e.error&&e.error.call(e.context,h,a,c),y.reject(h,"error",c),t&&b.event.trigger("ajaxError",[h,e,c]));t&&b.event.trigger("ajaxComplete",[h,e]);t&&!--b.active&&b.event.trigger("ajaxStop");e.complete&&e.complete.call(e.context,h,a);F=!0;e.timeout&&clearTimeout(u);setTimeout(function(){e.iframeTarget||x.remove();h.responseXML=null},100)}}var k=p[0],l,e,t,s,x,v,h,w,u,y=b.Deferred();
if(c)for(l=0;l<m.length;l++)c=b(m[l]),D?c.prop("disabled",!1):c.removeAttr("disabled");e=b.extend(!0,{},b.ajaxSettings,a);e.context=e.context||e;s="jqFormIO"+(new Date).getTime();e.iframeTarget?(x=b(e.iframeTarget),(l=x.attr2("name"))?s=l:x.attr2("name",s)):(x=b('<iframe name="'+s+'" src="'+e.iframeSrc+'" />'),x.css({position:"absolute",top:"-1000px",left:"-1000px"}));v=x[0];h={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},
setRequestHeader:function(){},abort:function(a){var c="timeout"===a?"timeout":"aborted";q("aborting upload... "+c);this.aborted=1;try{v.contentWindow.document.execCommand&&v.contentWindow.document.execCommand("Stop")}catch(d){}x.attr("src",e.iframeSrc);h.error=c;e.error&&e.error.call(e.context,h,c,a);t&&b.event.trigger("ajaxError",[h,e,c]);e.complete&&e.complete.call(e.context,h,c)}};(t=e.global)&&0===b.active++&&b.event.trigger("ajaxStart");t&&b.event.trigger("ajaxSend",[h,e]);if(e.beforeSend&&!1===
e.beforeSend.call(e.context,h,e))return e.global&&b.active--,y.reject(),y;if(h.aborted)return y.reject(),y;if(c=k.clk)if((l=c.name)&&!c.disabled)e.extraData=e.extraData||{},e.extraData[l]=c.value,"image"==c.type&&(e.extraData[l+".x"]=k.clk_x,e.extraData[l+".y"]=k.clk_y);var A=1,z=2;c=b("meta[name=csrf-token]").attr("content");if((l=b("meta[name=csrf-param]").attr("content"))&&c)e.extraData=e.extraData||{},e.extraData[l]=c;e.forceSync?f():setTimeout(f,10);var B,r,C=50,F,H=b.parseXML||function(a,b){window.ActiveXObject?
(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},J=b.parseJSON||function(a){return window.eval("("+a+")")},I=function(a,c,e){var d=a.getResponseHeader("content-type")||"",f="xml"===c||!c&&0<=d.indexOf("xml");a=f?a.responseXML:a.responseText;f&&"parsererror"===a.documentElement.nodeName&&b.error&&b.error("parsererror");e&&e.dataFilter&&(a=e.dataFilter(a,
c));"string"===typeof a&&("json"===c||!c&&0<=d.indexOf("json")?a=J(a):("script"===c||!c&&0<=d.indexOf("javascript"))&&b.globalEval(a));return a};return y}if(!this.length)return q("ajaxSubmit: skipping submit process - no element selected"),this;var n,f,p=this;"function"==typeof a&&(a={success:a});n=a.type||this.attr2("method");f=a.url||this.attr2("action");(f=(f="string"===typeof f?b.trim(f):"")||window.location.href||"")&&(f=(f.match(/^([^#]+)/)||[])[1]);a=b.extend(!0,{url:f,success:b.ajaxSettings.success,
type:n||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);f={};this.trigger("form-pre-serialize",[this,a,f]);if(f.veto)return q("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return q("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var l=a.traditional;void 0===l&&(l=b.ajaxSettings.traditional);var m=[],k,t=this.formToArray(a.semantic,m);a.data&&(a.extraData=a.data,k=b.param(a.data,
l));if(a.beforeSubmit&&!1===a.beforeSubmit(t,this,a))return q("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[t,this,a,f]);if(f.veto)return q("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;f=b.param(t,l);k&&(f=f?f+"&"+k:k);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+f,a.data=null):a.data=f;var s=[];a.resetForm&&s.push(function(){p.resetForm()});a.clearForm&&s.push(function(){p.clearForm(a.includeHidden)});
if(!a.dataType&&a.target){var w=a.success||function(){};s.push(function(c){var d=a.replaceTarget?"replaceWith":"html";b(a.target)[d](c).each(w,arguments)})}else a.success&&s.push(a.success);a.success=function(b,c,d){for(var f=a.context||this,g=0,k=s.length;g<k;g++)s[g].apply(f,[b,c,d||p,p])};if(a.error){var u=a.error;a.error=function(b,c,d){u.apply(a.context||this,[b,c,d,p])}}if(a.complete){var C=a.complete;a.complete=function(b,c){C.apply(a.context||this,[b,c,p])}}k=0<b('input[type=file]:enabled[value!=""]',
this).length;f="multipart/form-data"==p.attr("enctype")||"multipart/form-data"==p.attr("encoding");l=z&&B;q("fileAPI :"+l);var A;!1!==a.iframe&&(a.iframe||(k||f)&&!l)?a.closeKeepAlive?b.get(a.closeKeepAlive,function(){A=d(t)}):A=d(t):A=(k||f)&&l?c(t):b.ajax(a);p.removeData("jqxhr").data("jqxhr",A);for(k=0;k<m.length;k++)m[k]=null;this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){a=a||{};a.delegation=a.delegation&&b.isFunction(b.fn.on);if(!a.delegation&&0===this.length){var g=
this.selector,c=this.context;if(!b.isReady&&g)return q("DOM not ready, queuing ajaxForm"),b(function(){b(g,c).ajaxForm(a)}),this;q("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}return a.delegation?(b(document).off("submit.form-plugin",this.selector,w).off("click.form-plugin",this.selector,u).on("submit.form-plugin",this.selector,a,w).on("click.form-plugin",this.selector,a,u),this):this.ajaxFormUnbind().bind("submit.form-plugin",a,w).bind("click.form-plugin",
a,u)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(a,g){var c=[];if(0===this.length)return c;var d=this[0],n=a?d.getElementsByTagName("*"):d.elements;if(!n)return c;var f,p,l,m,k,q;f=0;for(q=n.length;f<q;f++)if(k=n[f],(l=k.name)&&!k.disabled)if(a&&d.clk&&"image"==k.type)d.clk==k&&(c.push({name:l,value:b(k).val(),type:k.type}),c.push({name:l+".x",value:d.clk_x},{name:l+".y",value:d.clk_y}));else if((m=b.fieldValue(k,!0))&&m.constructor==
Array){g&&g.push(k);p=0;for(k=m.length;p<k;p++)c.push({name:l,value:m[p]})}else if(z&&"file"==k.type)if(g&&g.push(k),m=k.files,m.length)for(p=0;p<m.length;p++)c.push({name:l,value:m[p],type:k.type});else c.push({name:l,value:"",type:k.type});else null!==m&&"undefined"!=typeof m&&(g&&g.push(k),c.push({name:l,value:m,type:k.type,required:k.required}));if(!a&&d.clk&&(n=b(d.clk),f=n[0],(l=f.name)&&!f.disabled&&"image"==f.type))c.push({name:l,value:n.val()}),c.push({name:l+".x",value:d.clk_x},{name:l+
".y",value:d.clk_y});return c};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var g=[];this.each(function(){var c=this.name;if(c){var d=b.fieldValue(this,a);if(d&&d.constructor==Array)for(var n=0,f=d.length;n<f;n++)g.push({name:c,value:d[n]});else null!==d&&"undefined"!=typeof d&&g.push({name:this.name,value:d})}});return b.param(g)};b.fn.fieldValue=function(a){for(var g=[],c=0,d=this.length;c<d;c++){var n=b.fieldValue(this[c],a);null===n||("undefined"==
typeof n||n.constructor==Array&&!n.length)||(n.constructor==Array?b.merge(g,n):g.push(n))}return g};b.fieldValue=function(a,g){var c=a.name,d=a.type,n=a.tagName.toLowerCase();void 0===g&&(g=!0);if(g&&(!c||a.disabled||"reset"==d||"button"==d||("checkbox"==d||"radio"==d)&&!a.checked||("submit"==d||"image"==d)&&a.form&&a.form.clk!=a||"select"==n&&-1==a.selectedIndex))return null;if("select"==n){var f=a.selectedIndex;if(0>f)return null;for(var c=[],n=a.options,p=(d="select-one"==d)?f+1:n.length,f=d?f:
0;f<p;f++){var l=n[f];if(l.selected){var m=l.value;m||(m=l.attributes&&l.attributes.value&&!l.attributes.value.specified?l.text:l.value);if(d)return m;c.push(m)}}return c}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",this).clearFields(a)})};b.fn.clearFields=b.fn.clearInputs=function(a){var g=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var c=this.type,d=this.tagName.toLowerCase();
if(g.test(c)||"textarea"==d)this.value="";else if("checkbox"==c||"radio"==c)this.checked=!1;else if("select"==d)this.selectedIndex=-1;else if("file"==c)/MSIE/.test(navigator.userAgent)?b(this).replaceWith(b(this).clone(!0)):b(this).val("");else if(a&&(!0===a&&/hidden/.test(c)||"string"==typeof a&&b(this).is(a)))this.value=""})};b.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};b.fn.enable=function(a){void 0===
a&&(a=!0);return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){void 0===a&&(a=!0);return this.each(function(){var g=this.type;"checkbox"==g||"radio"==g?this.checked=a:"option"==this.tagName.toLowerCase()&&(g=b(this).parent("select"),a&&(g[0]&&"select-one"==g[0].type)&&g.find("option").selected(!1),this.selected=a)})};b.fn.ajaxSubmit.debug=!1})(jQuery);
